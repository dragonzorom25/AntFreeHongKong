<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=3.0">
  <title th:text="${title} ?: 'MyBaseLink'">MyBaseLink</title>

  <th:block th:if="${_csrf} != null">
    <meta name="_csrf" th:content="${_csrf.token}" />
    <meta name="_csrf_header" th:content="${_csrf.headerName}" />
  </th:block>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <link rel="apple-touch-icon" sizes="57x57" href="/favicon/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/favicon/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/favicon/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/favicon/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/favicon/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/favicon/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/favicon/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/favicon/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/favicon/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/favicon/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="/css/common/commonLayout.css">
  <link rel="stylesheet" href="/css/common/commonTable.css">
  <link rel="stylesheet" href="/css/common/commonSearch.css">
  <link rel="stylesheet" href="/css/common/commonPagination.css">
  <link rel="stylesheet" href="/css/common/commonModal.css">
  <link rel="stylesheet" href="/css/common/commonToast.css">
  <link rel="stylesheet" href="/css/common/commonTop.css">
  <link rel="stylesheet" href="/css/common/commonLeft.css">

  <style>
    /* í˜ì´ì§€ í•˜ë‹¨ ì—¬ë°± í™•ë³´ (ì •ë³´ ë°” ë†’ì´ë§Œí¼) */
    body { padding-bottom: 28px !important; }
  </style>
</head>

<body style="position: relative; margin: 0; padding: 0;">

  <div style="position: sticky; top: 0; z-index: 5000;">
    <th:block th:replace="~{fragments/top :: topFragment}"></th:block>
  </div>

  <div id="sidebarOverlay" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0, 0, 0, 0.4); z-index: 2999; display: none; pointer-events: auto;"></div>

  <div id="layoutWrapper" style="position: relative; width: 100%; display: flex; align-items: stretch; min-height: calc(100vh - 50px);">
    <div th:replace="~{fragments/left :: leftFragment}"></div>

    <main id="mainContentArea" style="flex: 1; min-width: 0;">
      <!-- ë ˆì´ì•„ì›ƒ ë³¸ë¬¸ ì„¹ì…˜ -->
      <div class="content" layout:fragment="content"></div>
    </main>
  </div>

  <!-- âœ… í™˜ìœ¨ ì •ë³´ ë°” (Thymeleaf í‘œì¤€ ë¬¸ë²• ì ìš©) -->
<footer th:replace="~{fragments/bottom :: bottomFragment}"></footer>

  <script>
  /*
  | êµ¬ë¶„          | í™”ë©´í­(px)          | ë””ë°”ì´ìŠ¤ ì˜ˆì‹œ             | ë°˜ì‘í˜• ëª©ì                        |
	| ----------- 	| ------------------- | ------------------------- | -------------------- 				|
	| **ì´ˆì†Œí˜•í°** | `max-width: 360px`  | iPhone SE, Galaxy A10e    | ìµœì†Œ ëŒ€ì‘ (ê¸°ë³¸ í…ìŠ¤íŠ¸/ë²„íŠ¼ ì¶•ì†Œ) |
	| **ì†Œí˜•í°** | `max-width: 480px`  | Galaxy S8, iPhone 12 mini | ëª¨ë°”ì¼ ì„¸ë¡œ ëª¨ë“œ ê¸°ì¤€         	|
	| **ì¤‘í˜•í°** | `max-width: 768px`  | ëŒ€ë¶€ë¶„ ìŠ¤ë§ˆíŠ¸í°, ì„¸ë¡œ     | ë ˆì´ì•„ì›ƒ ì—¬ë°±, í°íŠ¸ ìë™ì¡°ì •     |
	| **íƒœë¸”ë¦¿** | `max-width: 1024px` | iPad, Galaxy Tab ì„¸ë¡œ     | ë¦¬ìŠ¤íŠ¸/í¼ í­ ì¡°ì ˆ           		|
	| **ë°ìŠ¤í¬íƒ‘ ê¸°ë³¸** | `> 1024px`      | ë…¸íŠ¸ë¶/PC             	 | ê¸°ë³¸ ë ˆì´ì•„ì›ƒ ìœ ì§€           		|
  */
  document.addEventListener("DOMContentLoaded", () => {
	  const sidebar = document.getElementById("left");
	  const overlay = document.getElementById("sidebarOverlay");

	  function forceCloseSidebar() {
	    if (sidebar && sidebar.classList.contains("open")) {
	      sidebar.classList.remove("open");
	      if (overlay) overlay.style.display = "none";
	    }
	  }

	  window.toggleSidebar = () => {
	    if (!sidebar) return;
	    const isOpen = sidebar.classList.contains("open");
	    if (isOpen) {
	      forceCloseSidebar();
	    } else {
	      sidebar.classList.add("open");
	      if (overlay) overlay.style.display = "block";
	    }
	  };

	  const handleCloseAction = (e) => {
	    if (!sidebar || !sidebar.classList.contains("open")) return;

	    // ğŸš© [í•„í„° 1] ì´ë²¤íŠ¸ê°€ ë°œìƒí•œ ì§€ì ì´ ë ˆí”„íŠ¸ ë©”ë‰´ ë‚´ë¶€ë¼ë©´ ì ˆëŒ€ ë‹«ì§€ ì•ŠìŒ
	    const path = e.composedPath();
	    if (path.includes(sidebar)) return;

	    // ğŸš© [í•„í„° 2] í† ê¸€ ë²„íŠ¼ ì˜ì—­ ë¬´ì‹œ
	    const toggleBtn = document.getElementById('menuToggle');
	    if (toggleBtn && path.includes(toggleBtn)) return;

	    // ğŸš© ìœ„ ì˜ì—­ë“¤ì´ ì•„ë‹ˆë©´ (ì¦‰, ì»¨í…ì¸  ì˜ì—­ì´ë©´) ë‹«ê¸°
	    forceCloseSidebar();
	  };

	  // âœ… wheel(íœ ): ì»¨í…ì¸  ì˜ì—­ì—ì„œ í•˜ë©´ ë‹«íˆê³ , ë ˆí”„íŠ¸ ì•ˆì—ì„œ í•˜ë©´ ìœ ì§€ë¨
	  window.addEventListener("wheel", handleCloseAction, { passive: true });

	  // âœ… mousedown(í´ë¦­): ì»¨í…ì¸  ì˜ì—­ í´ë¦­ ì‹œ ë‹«í˜
	  window.addEventListener("mousedown", handleCloseAction);

	  // âœ… touchmove(ëª¨ë°”ì¼ í„°ì¹˜): ì»¨í…ì¸  ì˜ì—­ ìŠ¤ì™€ì´í”„ ì‹œ ë‹«í˜
	  window.addEventListener("touchmove", handleCloseAction, { passive: true });

	  overlay?.addEventListener("click", forceCloseSidebar);
	});
  </script>

  <script src="/js/common/common_loadseq_1_Loading_op.js"></script>
  <script src="/js/common/common_loadseq_2_Notify_op.js"></script>
  <script src="/js/common/common_loadseq_3_Pagination_op.js"></script>
  <script src="/js/common/common_loadseq_4_Modal_op.js"></script>
  <script src="/js/common/common_loadseq_5_UnifiedList_op.js"></script>
  <script src="/js/common/common_loadseq_6_Left_op.js"></script>
  
  <th:block layout:fragment="pageScript"></th:block>

  <script>
    function setVhUnit() {
      const vh = window.innerHeight * 0.01;
      document.documentElement.style.setProperty('--vh', `${vh}px`);
    }
    setVhUnit(); 
    window.addEventListener("resize", setVhUnit); 
  </script>
</body>
</html>